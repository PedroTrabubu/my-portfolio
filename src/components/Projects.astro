---
import GitHub from "../icons/GitHub.astro";
import NextJS from "../icons/GitHub.astro";
import Tailwind from "../icons/GitHub.astro";

const TAGS = {
  NEXT: {
    name: "Next.js",
    class: "bg-black text-white",
    icon: NextJS,
  },
  TAILWIND: {
    name: "Tailwind CSS",
    class: "bg-[#003159] text-white",
    icon: Tailwind,
  },
};

const PROJECTS = [
  {
    title: "Calculadora JavaFX - Proyecto en Java",
    description:
      "Calculadora funcional hecha con JavaFX, soporte para teclado, operadores y par茅ntesis. Incluye interfaz moderna y soporte para entrada desde teclado.",
    link: "https://github.com/pedrotrabubu/calculadora-javafx",
    github: "https://github.com/pedrotrabubu/calculadora-javafx",
    video: "/Videos/Calculadora2.mp4",
    tags: [TAGS.NEXT, TAGS.TAILWIND],
  },
  {
    title: "Domaine du Salt - P谩gina React Multilenguaje",
    description:
      "Proyecto web desarrollado con React e i18next para soporte multilenguaje. P谩gina en construcci贸n con integraci贸n futura de base de datos MySQL. Dise帽o moderno, responsive y preparado para despliegue.",
    link: "https://github.com/PedroTrabubu/Domaine-Du-Salt",
    github: "https://github.com/PedroTrabubu/Domaine-Du-Salt",
    video: "/Videos/ChambreCapturaIntento2.mp4",
    tags: [TAGS.NEXT, TAGS.TAILWIND],
  },
  {
    title: "API REST Gesti贸n de Productos - Spring Boot & MySQL",
    description:
      "API REST desarrollada en Spring Boot con conexi贸n a base de datos MySQL. Permite gestionar productos, categor铆as y usuarios con operaciones CRUD completas. Implementa DTOs para control de datos, manejo de excepciones y filtros por stock y categor铆a.",
    link: "https://github.com/pedrotrabubu/api-rest-productos",
    github: "https://github.com/pedrotrabubu/api-rest-productos",
    video: "/Videos/Spring.mp4",
    tags: [TAGS.NEXT, TAGS.NEXT],
  },
  
];
---
<section id="proyectos" class="w-full mt-24">
<h2
    class="text-3xl md:text-4xl text-center font-bold tracking-tight text-gray-900 dark:text-white"
  >
    Proyectos
  </h2>

<div class="flex flex-col gap-y-16 mt-25">
  {
    PROJECTS.map(({ video, title, description, tags, link, github }) => (
      <article class="flex flex-col items-center space-y-8 md:flex-row md:space-x-8 md:space-y-0 group">
        <!--  Contenedor del video -->
        <div class="w-full md:w-1/2 flex justify-center">
          <div
            class="relative overflow-hidden rounded-xl shadow-xl border border-gray-700/40 bg-black max-w-lg transition duration-500 ease-in-out transform md:group-hover:-translate-y-1 md:group-hover:shadow-2xl"
          >
            <video
              class="lazy-video w-full h-full object-cover aspect-video object-center"
              preload="none"
              muted
              loop
              playsinline
              autoplay
            >
              <source src={video} type="video/mp4" />
              Tu navegador no soporta la reproducci贸n de video.
            </video>
          </div>
        </div>

        <!-- Descripci贸n -->
        <div class="w-full md:w-1/2 md:max-w-lg">
          <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100">
            {title}
          </h3>

          <ul class="flex flex-row mt-2 mb-2 gap-x-2">
            {tags.map((tag) => (
              <li>
                <span
                  class={`flex gap-x-2 rounded-full text-xs ${tag.class} py-1 px-2`}
                >
                  <tag.icon class="size-4" />
                  {tag.name}
                </span>
              </li>
            ))}
          </ul>

          <div class="mt-2 text-gray-700 dark:text-gray-400">
            {description}
          </div>

          <div class="mt-4 flex gap-4">
            <a
              href={link}
              target="_blank"
              class="text-green-600 hover:underline font-medium"
              >Ver proyecto</a
            >
            <a
              href={github}
              target="_blank"
              class="text-gray-500 hover:text-gray-300"
              >GitHub</a
            >
          </div>
        </div>
      </article>
    ))
  }
</div>
</section>
<!-- Script para lazy load de videos -->
<script>
  const videos = document.querySelectorAll<HTMLVideoElement>(".lazy-video");
  const options = { threshold: 0.25 };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      const video = entry.target as HTMLVideoElement;
      if (entry.isIntersecting) {
        if (video.paused) video.play();
      } else {
        video.pause();
      }
    });
  }, options);

  videos.forEach((video) => observer.observe(video));
</script>
